Thoroughly commented version for a friend